import json


dados = [{'id': '67334dcae53553fe4d66a884', 'cpfCnpj': '21.988.821/0001-58', 'razaoSocial': 'FRANCISCO DE JESUS COSTA FERREIRA FILHO', 'fantasia': 'DNA DO AÇAI', 'empresa': 1, 'data': '01-11-2024', 'hora': '11:45:04', 'usuCodigo': 3, 'operacao': 'A', 'tabela': 'CLIENTES', 'log': '[\r\n  {\r\n    "name": "EMPRESA",\r\n    "old": "1",\r\n    "new": "1"\r\n  },\r\n  {\r\n    "name": "CLI_CODIGO",\r\n    "old": "345",\r\n    "new": "345"\r\n  },\r\n  {\r\n    "name": "DATA_ULT_COMPRA",\r\n    "old": "2024-11-01",\r\n    "new": "2024-11-12"\r\n  },\r\n  {\r\n    "name": "VALOR_ULT_COMPRA",\r\n    "old": "1020.00",\r\n    "new": "1560.00"\r\n  },\r\n  {\r\n    "name": "NRO_COMPRAS",\r\n    "old": "92",\r\n    "new": "93"\r\n  },\r\n  {\r\n    "name": "TOTAL_COMPRAS",\r\n    "old": "171792.60",\r\n    "new": "173352.60"\r\n  }\r\n]', 'maquina': 'DESKTOP-4CMCGKA', 'executavel': 'Vendas.exe'}, {'id': '67334dcae53553fe4d66a885', 'cpfCnpj': '21.988.821/0001-58', 'razaoSocial': 'FRANCISCO DE JESUS COSTA FERREIRA FILHO', 'fantasia': 'DNA DO AÇAI', 'empresa': 1, 'data': '12-11-2024', 'hora': '08:45:04', 'usuCodigo': 3, 'operacao': 'A', 'tabela': 'PRODUTOS', 'log': '[\r\n  {\r\n    "name": "EMPRESA",\r\n    "old": "1",\r\n    "new": "1"\r\n  },\r\n  {\r\n    "name": "PRO_CODIGO",\r\n    "old": "4",\r\n    "new": "4"\r\n  },\r\n  {\r\n    "name": "ESTOQUE",\r\n    "old": "1540.00",\r\n    "new": "1460.00"\r\n  }\r\n]', 'maquina': 'DESKTOP-4CMCGKA', 'executavel': 'Vendas.exe'}, {'id': '67334dcae53553fe4d66a886', 'cpfCnpj': '21.988.821/0001-58', 'razaoSocial': 'FRANCISCO DE JESUS COSTA FERREIRA FILHO', 'fantasia': 'DNA DO AÇAI', 'empresa': 1, 'data': '12-11-2024', 'hora': '08:45:04', 'usuCodigo': 3, 'operacao': 'A', 'tabela': 'PRODUTOS', 'log': '[\r\n  {\r\n    "name": "EMPRESA",\r\n    "old": "1",\r\n    "new": "1"\r\n  },\r\n  {\r\n    "name": "PRO_CODIGO",\r\n    "old": "4",\r\n    "new": "4"\r\n  },\r\n  {\r\n    "name": "QTDE_VENDIDA",\r\n    "old": "169810.00",\r\n    "new": "169890.00"\r\n  }\r\n]', 'maquina': 'DESKTOP-4CMCGKA', 'executavel': 'Vendas.exe'}, {'id': '67334dcae53553fe4d66a887', 'cpfCnpj': '21.988.821/0001-58', 'razaoSocial': 'FRANCISCO DE JESUS COSTA FERREIRA FILHO', 'fantasia': 'DNA DO AÇAI', 'empresa': 1, 'data': '12-11-2024', 'hora': '08:45:04', 'usuCodigo': 3, 'operacao': 'A', 'tabela': 'PRODUTOS', 'log': '[\r\n  {\r\n    "name": "EMPRESA",\r\n    "old": "1",\r\n    "new": "1"\r\n  },\r\n  {\r\n    "name": "PRO_CODIGO",\r\n    "old": "4",\r\n    "new": "4"\r\n  },\r\n  {\r\n    "name": "DT_ULTIMA_VENDA",\r\n    "old": "2024-11-11",\r\n    "new": "2024-11-12"\r\n  }\r\n]', 'maquina': 'DESKTOP-4CMCGKA', 'executavel': 'Vendas.exe'}, {'id': '67335095e53553fe4d66a888', 'cpfCnpj': '21.988.821/0001-58', 'razaoSocial': 'FRANCISCO DE JESUS COSTA FERREIRA FILHO', 'fantasia': 'DNA DO AÇAI', 'empresa': 1, 'data': '12-11-2024', 'hora': '08:56:59', 'usuCodigo': 3, 'operacao': 'A', 'tabela': 'CONTAS_RECEBER', 'log': '[\r\n  {\r\n    "name": "EMPRESA",\r\n    "old": "1",\r\n    "new": "1"\r\n  },\r\n  {\r\n    "name": "LANCTO",\r\n    "old": "24445",\r\n    "new": "24445"\r\n  },\r\n  {\r\n    "name": "STATUS",\r\n    "old": "0",\r\n    "new": "4"\r\n  }\r\n]', 'maquina': 'DESKTOP-4CMCGKA', 'executavel': 'Financeiro.exe'}, {'id': '67335095e53553fe4d66a889', 'cpfCnpj': '21.988.821/0001-58', 'razaoSocial': 'FRANCISCO DE JESUS COSTA FERREIRA FILHO', 'fantasia': 'DNA DO AÇAI', 'empresa': 1, 'data': '12-11-2024', 'hora': '08:56:59', 'usuCodigo': 3, 'operacao': 'A', 'tabela': 'CONTAS_RECEBER', 'log': '[\r\n  {\r\n    "name": "EMPRESA",\r\n    "old": "1",\r\n    "new": "1"\r\n  },\r\n  {\r\n    "name": "LANCTO",\r\n    "old": "24386",\r\n    "new": "24386"\r\n  },\r\n  {\r\n    "name": "STATUS",\r\n    "old": "0",\r\n    "new": "4"\r\n  }\r\n]', 'maquina': 'DESKTOP-4CMCGKA', 'executavel': 'Financeiro.exe'}, {'id': '673350a7e53553fe4d66a88a', 'cpfCnpj': '21.988.821/0001-58', 'razaoSocial': 'FRANCISCO DE JESUS COSTA FERREIRA FILHO', 'fantasia': 'DNA DO AÇAI', 'empresa': 1, 'data': '12-11-2024', 'hora': '08:57:18', 'usuCodigo': 3, 'operacao': 'A', 'tabela': 'CONTAS_RECEBER', 'log': '[\r\n  {\r\n    "name": "EMPRESA",\r\n    "old": "1",\r\n    "new": "1"\r\n  },\r\n  {\r\n    "name": "LANCTO",\r\n    "old": "24447",\r\n    "new": "24447"\r\n  },\r\n  {\r\n    "name": "NRO_BOLETO",\r\n    "old": "",\r\n    "new": "09000000064753"\r\n  },\r\n  {\r\n    "name": "BOL_CODIGO",\r\n    "old": "",\r\n    "new": "1"\r\n  }\r\n]', 'maquina': 'DESKTOP-4CMCGKA', 'executavel': 'Financeiro.exe'}, {'id': '673350a7e53553fe4d66a88b', 'cpfCnpj': '21.988.821/0001-58', 'razaoSocial': 'FRANCISCO DE JESUS COSTA FERREIRA FILHO', 'fantasia': 'DNA DO AÇAI', 'empresa': 1, 'data': '12-11-2024', 'hora': '08:57:18', 'usuCodigo': 3, 'operacao': 'A', 'tabela': 'CONTAS_RECEBER', 'log': '[\r\n  {\r\n    "name": "EMPRESA",\r\n    "old": "1",\r\n    "new": "1"\r\n  },\r\n  {\r\n    "name": "LANCTO",\r\n    "old": "24446",\r\n    "new": "24446"\r\n  },\r\n  {\r\n    "name": "NRO_BOLETO",\r\n    "old": "",\r\n    "new": "09000000064745"\r\n  },\r\n  {\r\n    "name": "BOL_CODIGO",\r\n    "old": "",\r\n    "new": "1"\r\n  }\r\n]', 'maquina': 'DESKTOP-4CMCGKA', 'executavel': 'Financeiro.exe'}, {'id': '67335185e53553fe4d66a88c', 'cpfCnpj': '43.737.854/0001-68', 'razaoSocial': 'VITOR SPERANDIO BARROS MEI', 'fantasia': 'DOWMAQ', 'empresa': 1, 'data': '12-11-2024', 'hora': '09:00:55', 'usuCodigo': 3, 'operacao': 'A', 'tabela': 'CLIENTES', 'log': '[\r\n  {\r\n    "name": "EMPRESA",\r\n    "old": "1",\r\n    "new": "1"\r\n  },\r\n  {\r\n    "name": "CLI_CODIGO",\r\n    "old": "818",\r\n    "new": "818"\r\n  },\r\n  {\r\n    "name": "CPF_CNPJ",\r\n    "old": "",\r\n    "new": "280.132.719-00"\r\n  },\r\n  {\r\n    "name": "RG_IE",\r\n    "old": "",\r\n    "new": "33667217"\r\n  },\r\n  {\r\n    "name": "FONE",\r\n    "old": "",\r\n    "new": "(66)99686-3879"\r\n  },\r\n  {\r\n    "name": "CELULAR",\r\n    "old": "",\r\n    "new": "(66)99686-3879"\r\n  }\r\n]', 'maquina': 'DESKTOP-AL4L7HU', 'executavel': 'ErpNorte.exe'}, {'id': '6733521be53553fe4d66a88d', 'cpfCnpj': '43.737.854/0001-68', 'razaoSocial': 'VITOR SPERANDIO BARROS MEI', 'fantasia': 'DOWMAQ', 'empresa': 1, 'data': '12-11-2024', 'hora': '09:03:25', 'usuCodigo': 3, 'operacao': 'A', 'tabela': 'ORDENS_SERVICO', 'log': '[\r\n  {\r\n    "name": "EMPRESA",\r\n    "old": "1",\r\n    "new": "1"\r\n  },\r\n  {\r\n    "name": "ORDEM_SERVICO",\r\n    "old": "1667",\r\n    "new": "1667"\r\n  },\r\n  {\r\n    "name": "SUBTOTAL",\r\n    "old": "0.00",\r\n    "new": "0.01"\r\n  },\r\n  {\r\n    "name": "TOTAL",\r\n    "old": "0.00",\r\n    "new": "0.01"\r\n  }\r\n]', 'maquina': 'DESKTOP-AL4L7HU', 'executavel': 'Vendas.exe'}, {'id': '6733521be53553fe4d66a88e', 'cpfCnpj': '43.737.854/0001-68', 'razaoSocial': 'VITOR SPERANDIO BARROS MEI', 'fantasia': 'DOWMAQ', 'empresa': 1, 'data': '12-11-2024', 'hora': '09:03:26', 'usuCodigo': 3, 'operacao': 'A', 'tabela': 'ORDENS_SERVICO', 'log': '[\r\n  {\r\n    "name": "EMPRESA",\r\n    "old": "1",\r\n    "new": "1"\r\n  },\r\n  {\r\n    "name": "ORDEM_SERVICO",\r\n    "old": "1667",\r\n    "new": "1667"\r\n  },\r\n  {\r\n    "name": "MD5",\r\n    "old": "765bf36dfd7e1444f60aec6cc981156c",\r\n    "new": "c954f4ad663e6e3b659f8367b0e7dca6"\r\n  }\r\n]', 'maquina': 'DESKTOP-AL4L7HU', 'executavel': 'Vendas.exe'}, {'id': '6733521be53553fe4d66a88f', 'cpfCnpj': '43.737.854/0001-68', 'razaoSocial': 'VITOR SPERANDIO BARROS MEI', 'fantasia': 'DOWMAQ', 'empresa': 1, 'data': '12-11-2024', 'hora': '09:03:26', 'usuCodigo': 3, 'operacao': 'A', 'tabela': 'OS_ITENS', 'log': '[\r\n  {\r\n    "name": "EMPRESA",\r\n    "old": "1",\r\n    "new": "1"\r\n  },\r\n  {\r\n    "name": "ORDEM_SERVICO",\r\n    "old": "1667",\r\n    "new": "1667"\r\n  },\r\n  {\r\n    "name": "ITEM",\r\n    "old": "1",\r\n    "new": "1"\r\n  },\r\n  {\r\n    "name": "MD5",\r\n    "old": "",\r\n    "new": "8d7d526b5aeb2c6de7f05df190e7b6aa"\r\n  }\r\n]', 'maquina': 'DESKTOP-AL4L7HU', 'executavel': 'Vendas.exe'}, {'id': '67335260e53553fe4d66a890', 'cpfCnpj': '43.737.854/0001-68', 'razaoSocial': 'VITOR SPERANDIO BARROS MEI', 'fantasia': 'DOWMAQ', 'empresa': 1, 'data': '12-11-2024', 'hora': '09:04:34', 'usuCodigo': 3, 'operacao': 'A', 'tabela': 'ORDENS_SERVICO', 'log': '[\r\n  {\r\n    "name": "EMPRESA",\r\n    "old": "1",\r\n    "new": "1"\r\n  },\r\n  {\r\n    "name": "ORDEM_SERVICO",\r\n    "old": "1667",\r\n    "new": "1667"\r\n  },\r\n  {\r\n    "name": "CONCLUIDA",\r\n    "old": "N",\r\n    "new": "S"\r\n  },\r\n  {\r\n    "name": "DATA_FECHAMENTO",\r\n    "old": "",\r\n    "new": "2024-11-12"\r\n  },\r\n  {\r\n    "name": "HORA_FECHAMENTO",\r\n    "old": "",\r\n    "new": "09:04:34.0000"\r\n  }\r\n]', 'maquina': 'DESKTOP-AL4L7HU', 'executavel': 'Vendas.exe'}, {'id': '67335260e53553fe4d66a891', 'cpfCnpj': '43.737.854/0001-68', 'razaoSocial': 'VITOR SPERANDIO BARROS MEI', 'fantasia': 'DOWMAQ', 'empresa': 1, 'data': '12-11-2024', 'hora': '09:04:34', 'usuCodigo': 3, 'operacao': 'A', 'tabela': 'ORDENS_SERVICO', 'log': '[\r\n  {\r\n    "name": "EMPRESA",\r\n    "old": "1",\r\n    "new": "1"\r\n  },\r\n  {\r\n    "name": "ORDEM_SERVICO",\r\n    "old": "1667",\r\n    "new": "1667"\r\n  },\r\n  {\r\n    "name": "MD5",\r\n    "old": "c954f4ad663e6e3b659f8367b0e7dca6",\r\n    "new": "73f27c0f8a4ae5d5daa9906521563529"\r\n  }\r\n]', 'maquina': 'DESKTOP-AL4L7HU', 'executavel': 'Vendas.exe'}, {'id': '67335277e53553fe4d66a892', 'cpfCnpj': '43.737.854/0001-68', 'razaoSocial': 'VITOR SPERANDIO BARROS MEI', 'fantasia': 'DOWMAQ', 'empresa': 1, 'data': '12-11-2024', 'hora': '09:04:57', 'usuCodigo': 3, 'operacao': 'A', 'tabela': 'CONTAS_RECEBER', 'log': '[\r\n  {\r\n    "name": "EMPRESA",\r\n    "old": "1",\r\n    "new": "1"\r\n  },\r\n  {\r\n    "name": "LANCTO",\r\n    "old": "2126",\r\n    "new": "2126"\r\n  },\r\n  {\r\n    "name": "VALOR_PAGO",\r\n    "old": "",\r\n    "new": "0.01"\r\n  },\r\n  {\r\n    "name": "DATA_PAGTO",\r\n    "old": "",\r\n    "new": "2024-11-12"\r\n  },\r\n  {\r\n    "name": "LANCTO_VINCULADO",\r\n    "old": "",\r\n    "new": "2561"\r\n  }\r\n]', 'maquina': 'DESKTOP-AL4L7HU', 'executavel': 'Vendas.exe'}, {'id': '67335277e53553fe4d66a893', 'cpfCnpj': '43.737.854/0001-68', 'razaoSocial': 'VITOR SPERANDIO BARROS MEI', 'fantasia': 'DOWMAQ', 'empresa': 1, 'data': '12-11-2024', 'hora': '09:04:57', 'usuCodigo': 3, 'operacao': 'A', 'tabela': 'CLIENTES', 'log': '[\r\n  {\r\n    "name": "EMPRESA",\r\n    "old": "1",\r\n    "new": "1"\r\n  },\r\n  {\r\n    "name": "CLI_CODIGO",\r\n    "old": "536",\r\n    "new": "536"\r\n  },\r\n  {\r\n    "name": "DATA_ULT_COMPRA",\r\n    "old": "2024-04-10",\r\n    "new": "2024-11-12"\r\n  },\r\n  {\r\n    "name": "VALOR_ULT_COMPRA",\r\n    "old": "69.00",\r\n    "new": "0.01"\r\n  },\r\n  {\r\n    "name": "NRO_COMPRAS",\r\n    "old": "2",\r\n    "new": "3"\r\n  },\r\n  {\r\n    "name": "TOTAL_COMPRAS",\r\n    "old": "230.00",\r\n    "new": "230.01"\r\n  }\r\n]', 'maquina': 'DESKTOP-AL4L7HU', 'executavel': 'Vendas.exe'}, {'id': '67335277e53553fe4d66a894', 'cpfCnpj': '43.737.854/0001-68', 'razaoSocial': 'VITOR SPERANDIO BARROS MEI', 'fantasia': 'DOWMAQ', 'empresa': 1, 'data': '12-11-2024', 'hora': '09:04:57', 'usuCodigo': 3, 'operacao': 'A', 'tabela': 'ORDENS_SERVICO', 'log': '[\r\n  {\r\n    "name": "EMPRESA",\r\n    "old": "1",\r\n    "new": "1"\r\n  },\r\n  {\r\n    "name": "ORDEM_SERVICO",\r\n    "old": "1667",\r\n    "new": "1667"\r\n  },\r\n  {\r\n    "name": "PDV_EH_PROCESSADO",\r\n    "old": "N",\r\n    "new": "Z"\r\n  },\r\n  {\r\n    "name": "NFS",\r\n    "old": "",\r\n    "new": "1982"\r\n  },\r\n  {\r\n    "name": "NFS_2",\r\n    "old": "",\r\n    "new": "1982"\r\n  }\r\n]', 'maquina': 'DESKTOP-AL4L7HU', 'executavel': 'Vendas.exe'},{'id': '67334dcae53553fe4d66a884', 'cpfCnpj': '21.988.821/0001-58', 'razaoSocial': 'FRANCISCO DE JESUS COSTA FERREIRA FILHO', 'fantasia': 'DNA DO AÇAI', 'empresa': 1, 'data': '12-11-2024', 'hora': '08:45:04', 'usuCodigo': 3, 'operacao': 'A', 'tabela': 'CLIENTES', 'log': '[\r\n  {\r\n    "name": "EMPRESA",\r\n    "old": "1",\r\n    "new": "1"\r\n  },\r\n  {\r\n    "name": "CLI_CODIGO",\r\n    "old": "345",\r\n    "new": "345"\r\n  },\r\n  {\r\n    "name": "DATA_ULT_COMPRA",\r\n    "old": "2024-11-01",\r\n    "new": "2024-11-12"\r\n  },\r\n  {\r\n    "name": "VALOR_ULT_COMPRA",\r\n    "old": "1020.00",\r\n    "new": "1560.00"\r\n  },\r\n  {\r\n    "name": "NRO_COMPRAS",\r\n    "old": "92",\r\n    "new": "93"\r\n  },\r\n  {\r\n    "name": "TOTAL_COMPRAS",\r\n    "old": "173352.60",\r\n    "new": "171792.60"\r\n  }\r\n]', 'maquina': 'DESKTOP-4CMCGKA', 'executavel': 'Vendas.exe'}]

def gene(logs, valor_busca,campos_busca):
    resultados = []
    campos_geral=[]
    if valor_busca!="N/A":
        for log in logs:
            log_data = json.loads(log.get("log", "[]")) 
            campos = list({dado['name'] for dado in log_data})
            for c in campos:
                if c not in campos_geral:
                    campos_geral.append(c)

            for item in log_data:
                if (valor_busca.lower() in str(item.get("old", "")).lower()) or \
                (valor_busca.lower() in str(item.get("new", "")).lower()) and (campos_busca.lower() in str(item.get("name", "")).lower()):
                    resultados.append(log["id"])
                    break  
    else:
        resultados=dados
    return resultados

resultados = gene(dados, "818","CLI_CODIGO")
for _ in resultados:
    print("\n dados : "+str(_))
print(len(resultados))